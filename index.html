<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Form Pemeriksaan Unit</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icon-192.png" />
  <meta name="theme-color" content="#2196F3" />
  <style>
    body {
      font-family: sans-serif;
      max-width: 600px;
      margin: auto;
      padding: 16px;
    }
    label {
      font-weight: bold;
      margin-top: 12px;
      display: block;
    }
    select, input, textarea, button {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      margin-bottom: 12px;
      box-sizing: border-box;
    }
    .btn-group {
      display: flex;
      gap: 8px;
    }
    .btn-group button {
      flex: 1;
    }
  </style>
</head>
<body>
  <h2>Form Pemeriksaan Unit</h2>
  <form id="form">
    <label>Nama Peserta:</label>
    <input type="text" id="nama" required />

    <label>Tanggal:</label>
    <input type="date" id="tanggal" required />

    <label>Unit:</label>
    <select id="unit" required>
      <option value="">-- Pilih Unit --</option>
      <option>PC200-10 M0 CE</option>
      <option>PC210-10M0</option>
      <option>PC300-8M2</option>
      <option>PC350-8M2</option>
    </select>

    <label>Pengecekan Track Kanan:</label>
    <div class="btn-group" id="trackKanan">
      <button type="button" onclick="set('trackKanan','Baik')">Baik</button>
      <button type="button" onclick="set('trackKanan','Buruk')">Buruk</button>
    </div>

    <label>Pengecekan Track Kiri:</label>
    <div class="btn-group" id="trackKiri">
      <button type="button" onclick="set('trackKiri','Baik')">Baik</button>
      <button type="button" onclick="set('trackKiri','Buruk')">Buruk</button>
    </div>

    <label>Pengecekan Boom:</label>
    <div class="btn-group" id="boom">
      <button type="button" onclick="set('boom','Baik')">Baik</button>
      <button type="button" onclick="set('boom','Buruk')">Buruk</button>
    </div>

    <label>Pengecekan Arm:</label>
    <div class="btn-group" id="arm">
      <button type="button" onclick="set('arm','Baik')">Baik</button>
      <button type="button" onclick="set('arm','Buruk')">Buruk</button>
    </div>

    <label>Pengecekan Bucket:</label>
    <div class="btn-group" id="bucket">
      <button type="button" onclick="set('bucket','Baik')">Baik</button>
      <button type="button" onclick="set('bucket','Buruk')">Buruk</button>
    </div>

    <label>Pengecekan Area Engine:</label>
    <div class="btn-group" id="engine">
      <button type="button" onclick="set('engine','Baik')">Baik</button>
      <button type="button" onclick="set('engine','Buruk')">Buruk</button>
    </div>

    <label>Pengecekan Area Swing system:</label>
    <div class="btn-group" id="swing">
      <button type="button" onclick="set('swing','Baik')">Baik</button>
      <button type="button" onclick="set('swing','Buruk')">Buruk</button>
    </div>

    <label>Pengecekan Area Hydraulic Pump:</label>
    <div class="btn-group" id="hydraulic">
      <button type="button" onclick="set('hydraulic','Baik')">Baik</button>
      <button type="button" onclick="set('hydraulic','Buruk')">Buruk</button>
    </div>

    <label>Pengecekan Area Cooler:</label>
    <div class="btn-group" id="cooler">
      <button type="button" onclick="set('cooler','Baik')">Baik</button>
      <button type="button" onclick="set('cooler','Buruk')">Buruk</button>
    </div>

    <label>Pengecekan Area Cabin:</label>
    <div class="btn-group" id="cabin">
      <button type="button" onclick="set('cabin','Baik')">Baik</button>
      <button type="button" onclick="set('cabin','Buruk')">Buruk</button>
    </div>

    <label>Greasing:</label>
    <div class="btn-group" id="greasing">
      <button type="button" onclick="set('greasing','Sudah Greasing')">Sudah</button>
      <button type="button" onclick="set('greasing','Belum Greasing')">Belum</button>
    </div>

    <label>Note:</label>
    <textarea id="note" rows="3"></textarea>

    <button type="submit">Kirim</button>
  </form>

  <script>
    const data = {};
    function set(field, value) {
      data[field] = value;
      // Tandai pilihan aktif
      const group = document.getElementById(field);
      [...group.children].forEach(btn => btn.style.background = '');
      const btn = [...group.children].find(b => b.textContent === value);
      if (btn) btn.style.background = '#cce5ff';
    }

    document.getElementById("form").addEventListener("submit", function(e) {
      e.preventDefault();

      const unit = document.getElementById("unit").value;
      const formData = {
        namaPeserta: document.getElementById("nama").value,
        tanggal: document.getElementById("tanggal").value,
        unit: unit,
        trackKanan: data.trackKanan || '',
        trackKiri: data.trackKiri || '',
        boom: data.boom || '',
        arm: data.arm || '',
        bucket: data.bucket || '',
        engine: data.engine || '',
        swing: data.swing || '',
        hydraulic: data.hydraulic || '',
        cooler: data.cooler || '',
        cabin: data.cabin || '',
        greasing: data.greasing || '',
        note: document.getElementById("note").value
      };

      fetch("https://script.google.com/macros/s/AKfycbwIWbQbqwChvkGRmegTUyiDIt_XGXyYTo5wN6r_UOVsds5WKk4eowCOXh8pnqENzjC9/exec", {
        method: "POST",
        body: JSON.stringify(formData),
        headers: { "Content-Type": "application/json" }
      })
      .then(res => res.text())
      .then(msg => {
        alert("Data berhasil dikirim!");
        document.getElementById("form").reset();
        Object.keys(data).forEach(key => delete data[key]);
      })
      .catch(err => {
        alert("Gagal mengirim data!");
        console.error(err);
      });
    });

    // PWA support
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js').then(function() {
        console.log('SW registered');
      });
    }
  </script>
</body>
</html>
